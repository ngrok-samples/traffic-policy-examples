# Uses rand.double() to generate a random double between 0 and 1 when traffic reaches the endpoint
# Checks if the value is less than or equal to 0.5 and routes the traffic to different internal endpoints.
# You can change the value the random number is checked against to split the traffic in different ratios. 
# For example, >= 0.8 would send 80% of the traffic to one endpoint and 20% to the other.
on_http_request:
  - expressions:
      - rand.double() <= 0.5
    actions:
      - type: forward-internal
        config:
          url: https://a.internal
  - actions:
    - type: forward-internal
      config:
        url: https://b.internal